@model Models.Book

@{
    ViewData["Title"] = "Create";
}

<link href="~/css/jquery.ui.persian.datepicker.css" rel="stylesheet" />
<script src="~/js/jquery-1.8.3.min.js"></script>
<script src="~/js/jquery.ui.persian.datepicker.js"></script>
<style>
    #ui-datepicker-div {
        margin-right: 45%;
    }

    .ui-icon {
        width: 20px;
        height: 20px;
    }
</style>
<hr />
<h3 class="titlemain"> ایجاد کتاب</h3>
<div class="row">
    <div class="col-md-12">


        <div class="card">
            <div class="card-header" style="background-color:silver;font-size:18px;">

                ایجاد کتاب

            </div>
            <div class="card-body">


                <form asp-action="Create" enctype="multipart/form-data">
                    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                    <div class='form-group row'>
                        <label asp-for="Name" class="control-label col-sm-2"></label>
                        <div class='col-sm-8'>
                            <input asp-for="Name" class="form-control" />
                            <span asp-validation-for="Name" class="text-danger"></span>
                        </div>
                    </div>
                    <div class='form-group row'>
                        <label asp-for="CreateDateShamsi" class="control-label col-sm-2 "></label>
                        <div class='col-sm-8'>
                            <input type="text" id="CreateDateShamsi" name="CreateDateShamsi" class="datePicker form-control" />
                            <span asp-validation-for="CreateDateShamsi" class="text-danger"></span>
                        </div>
                    </div>
                    <div class='form-group row'>
                        <label asp-for="EndCreateDateShamsi" class="control-label col-sm-2 "></label>
                        <div class='col-sm-8'>
                            <input type="text" id="EndCreateDateShamsi" name="EndCreateDateShamsi" class="datePicker form-control" />
                            <span asp-validation-for="EndCreateDateShamsi" class="text-danger"></span>
                        </div>
                    </div>
                    <div class='form-group row'>
                        <label asp-for="FieldOfStudyId" class="control-label col-sm-2"></label>
                        <div class='col-sm-8'>

                            <select asp-for="FieldOfStudyId" class="form-control" asp-items="ViewBag.FieldOfStudyId">
                                <option value="0">انتخاب رشته تحصیلی</option>
                            </select>
                            <span asp-validation-for="FieldOfStudyId" class="text-danger"></span>
                        </div>

                    </div>

                    <div class='form-group row'>
                        <label asp-for="SectionId" class="control-label col-sm-2"></label>
                        <div class='col-sm-8'>
                            <select asp-for="SectionId" class="form-control" asp-items="ViewBag.SectionId">
                                <option value="0">انتخاب مقطع</option>
                            </select>
                            <span asp-validation-for="SectionId" class="text-danger"></span>
                        </div>

                    </div>

                    <div class='form-group row' id="lessonname">
                        <label class="control-label col-sm-2"> نام درس</label>
                        <div class='col-sm-8'>
                            <select id="LessonId" name="LessonId" class="form-control">
                            </select>
                        </div>

                    </div>

                    <div class='form-group row'>
                        <label asp-for="Author" class="control-label col-sm-2"></label>
                        <div class='col-sm-8'>
                            <input asp-for="Author" class="form-control" />
                            <span asp-validation-for="Author" class="text-danger"></span>
                        </div>
                    </div>

                    <div class='form-group row'>
                        <label asp-for="Publisher" class="control-label col-sm-2"></label>
                        <div class='col-sm-8'>
                            <input asp-for="Publisher" class="form-control" />
                            <span asp-validation-for="Publisher" class="text-danger"></span>
                        </div>
                    </div>
                    @*<div class='form-group row'>
                            <label asp-for="ContPage" class="control-label col-sm-2"></label>
                            <div class='col-sm-8'>
                                <input asp-for="ContPage" class="form-control" />
                                <span asp-validation-for="ContPage" class="text-danger"></span>
                            </div>
                        </div>*@

                    <div class='form-group row'>
                        <label asp-for="ProductTypeId" class="control-label col-sm-2"></label>
                        <div class='col-sm-8'>
                            <select asp-for="ProductTypeId" class="form-control" asp-items="ViewBag.ProductTypeId"></select>
                            <span asp-validation-for="ProductTypeId" class="text-danger"></span>
                        </div>

                    </div>

                    <div class='form-group row'>
                        <label asp-for="Cover" class="control-label col-sm-2"></label>
                        <div class='col-sm-8'>

                            <div class="col-md-12">
                                <input type="file" title="search image" id="file" class="custom-file-input" name="file" onchange="show(this)" />
                                <label class="custom-file-label" for="customFile">انتخاب جلد کتاب</label>
                            </div>

                        </div>
                    </div>

                    <div class='form-group row'>
                        <div class="control-label col-sm-2"></div>
                        <div class='col-sm-8'>
                            <div>
                                <img id="user_img" style="border: dashed 1px silver" height="600" width="400" />
                            </div>
                        </div>
                    </div>
                    @*<div class='form-group row'>
                            <label class="form-check-label col-sm-2"></label>
                            <div class='col-sm-9'>
                                <input class="form-check-input"  asp-for="Enable" /> @Html.DisplayNameFor(model => model.Enable)
                            </div>
                        </div>*@
                    <div class="form-group">
                        <input type="submit" value="ذخیره" class="btn btn-primary" />
                    </div>
                </form>

            </div>
        </div>





    </div>
</div>

<div>
    <a asp-action="Index">برگشت به لیست</a>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
<script>
    function show(input) {
        if (input.files && input.files[0]) {
            var filerdr = new FileReader();
            filerdr.onload = function (e) {
                $('#user_img').attr('src', e.target.result);
            }
            filerdr.readAsDataURL(input.files[0]);
        }
    }
    $('input.datePicker').datepicker({
        dateFormat: 'yy/mm/dd'
    });

    $(document).ready(function () {
        $('#lessonname').hide();
        $('#SectionId,#FieldOfStudyId').change(function () {
            var dd = $('#SectionId').parent;

            $('#lessonname').show();
            var idFileadOfStudy = $("#FieldOfStudyId").val();
            var idSection = $("#SectionId").val();

            $.ajax({

                type: "POST",

                dataType: "json",

                data: { idFileadOfStudy: idFileadOfStudy, idSection: idSection },

                url: "/Books/GetLesson",

                error: function (response) {
                    alert("error");
                },

                success: function (response) {
                    $('#LessonId')
                        .find('option')
                        .remove()
                        .end();
                    console.log(response);
                    $.each(response, function (index, value) {
                        $("#LessonId").append(" <option value=" + value['id'] + ">" + value['name'] + "</option>");
                    });
                },
                complete: function (response) {

                },
            });

        });
    });

</script>
